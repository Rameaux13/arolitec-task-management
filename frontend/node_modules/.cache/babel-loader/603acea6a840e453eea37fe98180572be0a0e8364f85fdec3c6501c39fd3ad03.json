{"ast":null,"code":"import axios from 'axios';\nimport authService from './authService';\nconst API_URL = 'http://localhost:3333';\n\n// Créer une instance Axios avec configuration de base\nconst apiClient = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Intercepteur pour ajouter automatiquement le token JWT à chaque requête\napiClient.interceptors.request.use(config => {\n  const token = authService.getToken();\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Intercepteur pour gérer les erreurs d'authentification\napiClient.interceptors.response.use(response => response, error => {\n  var _error$response;\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    // Token expiré ou invalide, rediriger vers login\n    authService.logout();\n    window.location.href = '/login';\n  }\n  return Promise.reject(error);\n});\nclass ApiService {\n  // Récupérer toutes les tâches (ADMIN ONLY)\n  async getAllTasks(page = 1, limit = 10, status, search) {\n    const params = new URLSearchParams();\n    params.append('page', page.toString());\n    params.append('limit', limit.toString());\n    if (status) params.append('status', status);\n    if (search) params.append('search', search);\n    const response = await apiClient.get(`/tasks?${params.toString()}`);\n\n    // Transformer la réponse backend en format attendu\n    return {\n      data: response.data.tasks || [],\n      total: response.data.total || 0,\n      page: response.data.page || 1,\n      limit: limit\n    };\n  }\n\n  // Récupérer MES tâches (USER)\n  async getMyTasks(page = 1, limit = 10, status, search) {\n    const params = new URLSearchParams();\n    params.append('page', page.toString());\n    params.append('limit', limit.toString());\n    if (status) params.append('status', status);\n    if (search) params.append('search', search);\n    const response = await apiClient.get(`/tasks/my-tasks?${params.toString()}`);\n\n    // Transformer la réponse backend en format attendu\n    return {\n      data: response.data.tasks || [],\n      total: response.data.total || 0,\n      page: response.data.page || 1,\n      limit: limit\n    };\n  }\n\n  // Récupérer une tâche par ID\n  async getTaskById(id) {\n    const response = await apiClient.get(`/tasks/${id}`);\n    return response.data;\n  }\n\n  // Créer une nouvelle tâche\n  async createTask(data) {\n    const response = await apiClient.post('/tasks', data);\n    return response.data;\n  }\n\n  // Mettre à jour une tâche\n  async updateTask(id, data) {\n    const response = await apiClient.patch(`/tasks/${id}`, data);\n    return response.data;\n  }\n\n  // Supprimer une tâche\n  async deleteTask(id) {\n    await apiClient.delete(`/tasks/${id}`);\n  }\n\n  // Assigner une tâche à un utilisateur (ADMIN ONLY)\n  async assignTask(taskId, userId) {\n    const response = await apiClient.post(`/tasks/${taskId}/assign/${userId}`);\n    return response.data;\n  }\n}\nexport default new ApiService();","map":{"version":3,"names":["axios","authService","API_URL","apiClient","create","baseURL","headers","interceptors","request","use","config","token","getToken","Authorization","error","Promise","reject","response","_error$response","status","logout","window","location","href","ApiService","getAllTasks","page","limit","search","params","URLSearchParams","append","toString","get","data","tasks","total","getMyTasks","getTaskById","id","createTask","post","updateTask","patch","deleteTask","delete","assignTask","taskId","userId"],"sources":["C:/Users/KEKEROS/OneDrive/Bureau/AROLITEC/frontend/src/services/api.ts"],"sourcesContent":["import axios, { AxiosInstance } from 'axios';\r\nimport { Task, CreateTaskDto, UpdateTaskDto, TasksResponse } from '../types/task.types';\r\nimport authService from './authService';\r\n\r\nconst API_URL = 'http://localhost:3333';\r\n\r\n// Créer une instance Axios avec configuration de base\r\nconst apiClient: AxiosInstance = axios.create({\r\n  baseURL: API_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Intercepteur pour ajouter automatiquement le token JWT à chaque requête\r\napiClient.interceptors.request.use(\r\n  (config) => {\r\n    const token = authService.getToken();\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Intercepteur pour gérer les erreurs d'authentification\r\napiClient.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      // Token expiré ou invalide, rediriger vers login\r\n      authService.logout();\r\n      window.location.href = '/login';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nclass ApiService {\r\n  // Récupérer toutes les tâches (ADMIN ONLY)\r\n  async getAllTasks(page: number = 1, limit: number = 10, status?: string, search?: string): Promise<TasksResponse> {\r\n    const params = new URLSearchParams();\r\n    params.append('page', page.toString());\r\n    params.append('limit', limit.toString());\r\n    if (status) params.append('status', status);\r\n    if (search) params.append('search', search);\r\n\r\n    const response = await apiClient.get<any>(`/tasks?${params.toString()}`);\r\n    \r\n    // Transformer la réponse backend en format attendu\r\n    return {\r\n      data: response.data.tasks || [],\r\n      total: response.data.total || 0,\r\n      page: response.data.page || 1,\r\n      limit: limit\r\n    };\r\n  }\r\n\r\n  // Récupérer MES tâches (USER)\r\n  async getMyTasks(page: number = 1, limit: number = 10, status?: string, search?: string): Promise<TasksResponse> {\r\n    const params = new URLSearchParams();\r\n    params.append('page', page.toString());\r\n    params.append('limit', limit.toString());\r\n    if (status) params.append('status', status);\r\n    if (search) params.append('search', search);\r\n\r\n    const response = await apiClient.get<any>(`/tasks/my-tasks?${params.toString()}`);\r\n    \r\n    // Transformer la réponse backend en format attendu\r\n    return {\r\n      data: response.data.tasks || [],\r\n      total: response.data.total || 0,\r\n      page: response.data.page || 1,\r\n      limit: limit\r\n    };\r\n  }\r\n\r\n  // Récupérer une tâche par ID\r\n  async getTaskById(id: string): Promise<Task> {\r\n    const response = await apiClient.get<Task>(`/tasks/${id}`);\r\n    return response.data;\r\n  }\r\n\r\n  // Créer une nouvelle tâche\r\n  async createTask(data: CreateTaskDto): Promise<Task> {\r\n    const response = await apiClient.post<Task>('/tasks', data);\r\n    return response.data;\r\n  }\r\n\r\n  // Mettre à jour une tâche\r\n  async updateTask(id: string, data: UpdateTaskDto): Promise<Task> {\r\n    const response = await apiClient.patch<Task>(`/tasks/${id}`, data);\r\n    return response.data;\r\n  }\r\n\r\n  // Supprimer une tâche\r\n  async deleteTask(id: string): Promise<void> {\r\n    await apiClient.delete(`/tasks/${id}`);\r\n  }\r\n\r\n  // Assigner une tâche à un utilisateur (ADMIN ONLY)\r\n  async assignTask(taskId: string, userId: string): Promise<Task> {\r\n    const response = await apiClient.post<Task>(`/tasks/${taskId}/assign/${userId}`);\r\n    return response.data;\r\n  }\r\n}\r\n\r\nexport default new ApiService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}